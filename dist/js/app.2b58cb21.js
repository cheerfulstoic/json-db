(function(e){function t(t){for(var a,u,o=t[0],s=t[1],c=t[2],l=0,f=[];l<o.length;l++)u=o[l],Object.prototype.hasOwnProperty.call(r,u)&&r[u]&&f.push(r[u][0]),r[u]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);d&&d(t);while(f.length)f.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var s=n[o];0!==r[s]&&(a=!1)}a&&(i.splice(t--,1),e=u(u.s=n[0]))}return e}var a={},r={app:0},i=[];function u(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=e,u.c=a,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)u.d(n,a,function(t){return e[t]}.bind(null,a));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/json-db/dist/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"001e":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("9ab4"),r=a.__importDefault(n("2b0e")),i=a.__importDefault(n("2ef0"));t.default=r.default.extend({name:"Definition",data:function(){return{option_to_add:null}},props:{value:Object},methods:{options:function(){return this.value.options||[]},add_option:function(){var e=this.options();e.push(this.option_to_add),this.value.options=i.default.uniq(e),this.option_to_add=null},remove_option:function(e,t){this.value.options=i.default.reject(this.options(),(function(t){return t==e}))}}})},"0538":function(e,t,n){"use strict";n.r(t);var a=n("5f04"),r=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},"0cf2":function(e,t,n){"use strict";n.r(t);var a=n("2766"),r=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},"0d8c":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("9ab4"),r=a.__importDefault(n("2b0e"));t.default=r.default.extend({name:"String",data:function(){return{}},props:{value:String},methods:{update_value:function(e){this.$emit("input",e.target.value)}}})},"0e4e":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"input-group"},[n("textarea",{ref:"the_input",staticClass:"form-control",attrs:{rows:"3"},domProps:{value:e.value},on:{input:e.update_value}})])},r=[];n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},1250:function(e,t,n){"use strict";n.r(t);var a=n("8c5b"),r=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},"207a":function(e,t,n){},2766:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("9ab4"),r=a.__importDefault(n("2b0e"));t.default=r.default.extend({name:"String",data:function(){return{}},props:{value:String},methods:{update_value:function(e){this.$emit("input",e.target.value)}}})},"2cc0":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.database.sheets.length?n("a",{attrs:{href:e.json_file_data_url(),download:e.project_name+".db.json"}},[e._v("Save JSON")]):e._e(),n("Graph",{attrs:{id:"graph",database:e.database,current_focus:e.current_focus},on:{focus_record:e.focus_record}}),n("div",{staticClass:"form-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.project_name,expression:"project_name"}],attrs:{type:"text"},domProps:{value:e.project_name},on:{input:function(t){t.target.composing||(e.project_name=t.target.value)}}})]),n("ul",{staticClass:"nav nav-tabs"},[e._l(e.database.sheets,(function(t){return n("li",{key:t._id,staticClass:"nav-item"},[n("a",{class:["nav-link","active",{selected:e.current_sheet_id===t._id}],on:{click:function(n){return e.change_sheet(t._id)}}},[n("div",{staticClass:"marker",style:"background-color:"+t.hex_color}),e._v(" "+e._s(t.name)+" ")])])})),n("li",{staticClass:"nav-item"},[n("a",{staticClass:"btn btn-primary add-sheet-btn",on:{click:e.add_sheet}},[e._v("Add Sheet")])])],2),e._l(e.database.sheets,(function(t){return n("div",{key:t._id},[e.current_sheet_id===t._id?n("Sheet",{attrs:{sheet:t,database:e.database,current_focus:e.current_focus},on:{focus_record:e.focus_record}}):e._e()],1)})),e.database.sheets.length?e._e():n("div",{class:{hover:e.upload_highlighted},attrs:{id:"file-upload"},on:{drop:function(t){return t.preventDefault(),e.upload(t)},dragover:function(t){return t.preventDefault(),e.highlight_upload(t)},dragleave:function(t){return t.preventDefault(),e.unhighlight_upload(t)}}},[e._v(" Drag here to upload file ")]),n("hr"),n("button",{staticClass:"btn btn-primary toggle-json-btn",on:{click:e.taggle_json}},[e._v("Toggle JSON")]),e.show_json?n("pre",{staticClass:"json-output"},[e._v(e._s(e.json()))]):e._e()],2)},r=[];n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},3383:function(e,t,n){"use strict";n("99af"),n("4de4"),n("5db7"),n("caad"),n("d81d"),n("73d9"),n("b0c0"),n("ac1f"),n("2532"),n("1276");var a=n("278c");Object.defineProperty(t,"__esModule",{value:!0});var r=n("9ab4"),i=r.__importDefault(n("2b0e")),u=r.__importStar(n("a4c9")),o=r.__importDefault(n("2ef0")),s=n("4e46");t.default=i.default.extend({name:"Graph",props:{database:u.Database,current_focus:Object},mounted:function(){this.refresh()},data:function(){return{sheet_names:o.default.map(this.database.sheets,"name"),nodes_array:[],edges_array:[],network:null,show_body:!1}},watch:{database:{handler:function(e,t){this.refresh()},deep:!0},sheet_names:{handler:function(e,t){this.refresh()}},current_focus:{handler:function(e,t){this.focus()}}},methods:{toggle:function(){this.show_body=!this.show_body,this.show_body&&(this.sheet_names=o.default.map(this.database.sheets,"name"),this.refresh())},refresh:function(){var e=this,t=this.database.sheets[0];if(!t)return null;var n=o.default.last(t.record_data);if(!n)return null;JSON.stringify(n);this.nodes_array=o.default.flatMap(this.database.sheets,(function(t){if(e.sheet_names.includes(t.name)){var n=t.unique_id_field();return o.default.map(t.records(),(function(e){return{id:"".concat(t._id,"|").concat(e._id),label:e[n],color:t.hex_color}}))}return[]}));var r=new s.DataSet(this.nodes_array);this.edges_array=o.default.flatMap(this.database.sheets,(function(e){var t=o.default.filter(e.definitions,(function(e){return"references"==e.type}));return o.default.flatMap(e.record_data,(function(n){return o.default.flatMap(t,(function(t){return o.default.map(n[t._id],(function(a){return{from:"".concat(e._id,"|").concat(n._id),to:"".concat(a.sheet_id,"|").concat(a.record_id),label:t.name,arrows:"to"}}))}))}))}));var i=new s.DataSet(this.edges_array),u={nodes:r,edges:i},c=document.getElementById("mynetwork");if(!c)return null;this.network=new s.Network(c,u,{layout:{randomSeed:0x7b12ff904e75},interaction:{zoomView:!1}}),this.network.on("click",(function(t){var n=t.nodes[0];if(n){var r=n.split("|"),i=a(r,2),u=i[0],o=i[1];e.$emit("focus_record",u,o)}})),this.focus()},focus:function(){if(this.current_focus){var e="".concat(this.current_focus.sheet_id,"|").concat(this.current_focus.record_id);this.network.selectNodes([e]),this.network.focus(e,{scale:1,animation:!0})}}}})},"38df":function(e,t,n){"use strict";n.r(t);var a=n("001e"),r=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},"39aa":function(e,t,n){"use strict";n.r(t);var a=n("0d8c"),r=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},"3dfd":function(e,t,n){"use strict";n.r(t);var a=n("2cc0"),r=n("6f68");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("5c0b");var u=n("2877"),o=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,null,null);t["default"]=o.exports},5443:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"row"},[n("div",{staticClass:"col col-md-9"},[e._v(" "+e._s(e.value.name)+" "),e.value.unique_id?n("span",[e._v("âœ¨")]):e._e()]),n("div",{staticClass:"col col-md-3"},[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"modal-"+e.value._id,expression:"'modal-' + value._id"}]},[e._v("Edit")])],1)]),n("b-modal",{attrs:{id:"modal-"+e.value._id,title:"BootstrapVue"}},[n("div",{staticClass:"form-group"},[n("label",[e._v(" Name "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.value.name,expression:"value.name"}],staticClass:"form-control",domProps:{value:e.value.name},on:{input:function(t){t.target.composing||e.$set(e.value,"name",t.target.value)}}})])]),n("div",{staticClass:"form-group"},[n("label",[e._v(" Unique ID? "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.value.unique_id,expression:"value.unique_id"}],attrs:{type:"checkbox",id:"unique_id"},domProps:{checked:Array.isArray(e.value.unique_id)?e._i(e.value.unique_id,null)>-1:e.value.unique_id},on:{change:function(t){var n=e.value.unique_id,a=t.target,r=!!a.checked;if(Array.isArray(n)){var i=null,u=e._i(n,i);a.checked?u<0&&e.$set(e.value,"unique_id",n.concat([i])):u>-1&&e.$set(e.value,"unique_id",n.slice(0,u).concat(n.slice(u+1)))}else e.$set(e.value,"unique_id",r)}}})])]),n("div",{staticClass:"form-group"},[n("label",[e._v(" Type "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.value.type,expression:"value.type"}],staticClass:"form-control",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.value,"type",t.target.multiple?n:n[0])}}},[n("option",{attrs:{disabled:"",value:""}},[e._v("Select one")]),n("option",{attrs:{value:"string"}},[e._v("String")]),n("option",{attrs:{value:"text_area"}},[e._v("Text Area")]),n("option",{attrs:{value:"integer"}},[e._v("Integer")]),n("option",{attrs:{value:"select_one"}},[e._v("Select One")]),n("option",{attrs:{value:"references"}},[e._v("References")])])])]),"select_one"==e.value.type?n("div",{staticClass:"form-group"},[n("label",[n("b-list-group",e._l(e.options(),(function(t){return n("b-list-group-item",{key:t},[e._v(" "+e._s(t)+" "),n("b-button",{staticClass:"float-right",on:{click:function(n){return e.remove_option(t,n)}}},[e._v("Remove")])],1)})),1),n("input",{directives:[{name:"model",rawName:"v-model",value:e.option_to_add,expression:"option_to_add"}],staticClass:"form-control",attrs:{placeholder:"New option"},domProps:{value:e.option_to_add},on:{input:function(t){t.target.composing||(e.option_to_add=t.target.value)}}}),n("b-button",{on:{click:e.add_option}},[e._v("Add Option")])],1)]):e._e()])],1)},r=[];n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},"54a4":function(e,t,n){"use strict";var a=n("b1e3"),r=n.n(a);r.a},"55c2":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a",{staticClass:"btn btn-primary",on:{click:e.toggle}},[n("span",{directives:[{name:"show",rawName:"v-show",value:!e.show_body,expression:"!show_body"}]},[e._v("Show")]),n("span",{directives:[{name:"show",rawName:"v-show",value:e.show_body,expression:"show_body"}]},[e._v("Hide")]),e._v(" Graph ")]),e.show_body?n("div",[n("div",{staticClass:"top"},e._l(this.database.sheets,(function(t){return n("span",{key:t._id,staticClass:"sheet-option",style:"color:"+t.hex_color},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.sheet_names,expression:"sheet_names"}],attrs:{type:"checkbox",id:"checkbox"},domProps:{value:t.name,checked:Array.isArray(e.sheet_names)?e._i(e.sheet_names,t.name)>-1:e.sheet_names},on:{change:function(n){var a=e.sheet_names,r=n.target,i=!!r.checked;if(Array.isArray(a)){var u=t.name,o=e._i(a,u);r.checked?o<0&&(e.sheet_names=a.concat([u])):o>-1&&(e.sheet_names=a.slice(0,o).concat(a.slice(o+1)))}else e.sheet_names=i}}}),e._v(" "+e._s(t.name)+" ")])])})),0),n("div",{ref:"mynetwork",staticClass:"vis-graph",attrs:{id:"mynetwork"}})]):e._e()])},r=[];n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},"5c0b":function(e,t,n){"use strict";var a=n("9c0c"),r=n.n(a);r.a},"5f04":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("9ab4"),r=a.__importDefault(n("2b0e")),i=a.__importStar(n("a4c9"));t.default=r.default.extend({name:"Sheet",props:{result:Object,database:i.Database}})},"670b":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"input-group"},[n("input",{ref:"the_input",staticClass:"form-control",attrs:{type:"number"},domProps:{value:e.value},on:{input:e.update_value}})])},r=[];n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},"6f68":function(e,t,n){"use strict";n.r(t);var a=n("78c7"),r=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},"74fb":function(e,t,n){"use strict";n.r(t);var a=n("670b"),r=n("7b9e");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("8e5d");var u=n("2877"),o=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,"e23b5940",null);t["default"]=o.exports},"75db":function(e,t,n){},"78c7":function(e,t,n){"use strict";n("d81d"),n("b0c0"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),Object.defineProperty(t,"__esModule",{value:!0});var a=n("9ab4"),r=a.__importDefault(n("2b0e")),i=a.__importDefault(n("5f5b")),u=a.__importDefault(n("fceb")),o=a.__importDefault(n("f972")),s=a.__importDefault(n("2ef0"));r.default.use(i.default);var c=a.__importStar(n("a4c9")),d=new c.Sheet("Test","sheet_1",null,[{name:"id",type:"string",unique_id:!0},{name:"msg",type:"text_area"},{name:"foo",type:"integer"},{name:"bar",type:"references"}],[{id:"unreferenced",msg:"Fun",foo:6},{_id:"ggg123",id:"blah",msg:"Hello",foo:2},{_id:"hhh123",id:"bloh",msg:"Hullo",bar:[{sheet_id:"sheet_1",record_id:"ggg123"}]},{_id:"abc123",id:"blum",msg:"Heja",bar:[{sheet_id:"sheet_1",record_id:"hhh123"},{sheet_id:"sheet_2",record_id:"flub"}]}]),l=new c.Sheet("Influencers","sheet_2",null,[{name:"label",type:"string",unique_id:!0},{name:"description",type:"text_area"},{name:"influencable",type:"references"}],[{_id:"flub",label:"Huh",description:"Something long, preferably",influencable:[{sheet_id:"sheet_1",record_id:"hhh123"}]}]),f=new c.Database([d,l]);t.default=r.default.extend({name:"app",components:{Graph:o.default,Sheet:u.default},data:function(){return{database:new c.Database([]),current_sheet_id:f.sheets[0]._id,current_focus:null,project_name:"Project Name",upload_highlighted:!1,show_json:!1}},methods:{upload:function(e){var t=this;this.upload_highlighted=!1,e.dataTransfer.files.length>1&&alert("You cannot upload more than one file");var n=e.dataTransfer.files[0],a=(e.dataTransfer.items[0],new FileReader);a.onload=function(e){var n=JSON.parse(e.target.result),a=s.default.map(n.sheets,(function(e){return new c.Sheet(e.name,e._id,e.hex_color,e.definitions,n.records[e.name])}));t.database=new c.Database(a),t.current_sheet_id=t.database.sheets[0]._id},a.readAsText(n)},highlight_upload:function(){this.upload_highlighted=!0},unhighlight_upload:function(){this.upload_highlighted=!1},add_sheet:function(){var e=this.database.sheets.length+1;this.database.add_sheet(new c.Sheet("Sheet #".concat(e),null,null,[],[]))},change_sheet:function(e){this.current_sheet_id=e},focus_record:function(e,t){this.current_focus={sheet_id:e,record_id:t},this.current_sheet_id=e},json:function(){return JSON.stringify(this.database.json_data(),null,2)},json_file_data_url:function(){var e=new Blob([this.json()],{type:"application/json"});return URL.createObjectURL(e)},taggle_json:function(){this.show_json=!this.show_json}},computed:{}})},"79e3":function(e,t,n){"use strict";n("99af"),n("caad"),n("d81d"),n("ac1f"),n("2532"),n("841c"),Object.defineProperty(t,"__esModule",{value:!0});var a=n("9ab4"),r=a.__importDefault(n("2b0e")),i=a.__importDefault(n("8d65")),u=a.__importDefault(n("2ef0")),o=a.__importStar(n("a4c9"));t.default=r.default.extend({name:"String",components:{RecordResult:i.default},data:function(){return{match_text:null}},props:{value:Array,record_id:String,database:o.Database},methods:{update_value:function(e){this.$emit("input",e.target.value)},search_results:function(){var e=this;if(!this.match_text)return[];var t=u.default.map(this.value,"record_id");return u.default(this.database.search("".concat(this.match_text))).map((function(e){return{id:e.id,sheet:e.sheet,record:e.sheet.record_values(e.record)}})).reject((function(n){return n.id===e.record_id||t.includes(n.id)})).value()},referenced_records:function(){var e=this;return u.default.map(this.value,(function(t){var n=e.database.fetch_record(t);if(n)return u.default.set(n,"record",n.sheet.record_values(n.record))}))},choose:function(e,t){this.$emit("input",(this.value||[]).concat([{record_id:e.id,sheet_id:e.sheet._id}])),this.match_text=null},remove:function(e){this.$emit("input",u.default.reject(this.value,(function(t){return t.record_id==e.id})))}}})},"7b9e":function(e,t,n){"use strict";n.r(t);var a=n("fb57"),r=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},8451:function(e,t,n){},"8ac8":function(e,t,n){"use strict";n.r(t);var a=n("fa12"),r=n("a7f4");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("9aa2");var u=n("2877"),o=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,"1f888b56",null);t["default"]=o.exports},"8c5b":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("9ab4"),r=a.__importDefault(n("2b0e"));t.default=r.default.extend({name:"Reference",data:function(){return{}},props:{value:String,definition:Object},methods:{update_value:function(e){this.$emit("input",e.target.value)}}})},"8d65":function(e,t,n){"use strict";n.r(t);var a=n("d543"),r=n("0538");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("54a4");var u=n("2877"),o=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,"20d09f6a",null);t["default"]=o.exports},"8e5d":function(e,t,n){"use strict";var a=n("d2c3"),r=n.n(a);r.a},"9aa2":function(e,t,n){"use strict";var a=n("8451"),r=n.n(a);r.a},"9c0c":function(e,t,n){},"9f79":function(e,t,n){"use strict";n.r(t);var a=n("e829"),r=n("1250");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("c2b3");var u=n("2877"),o=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,"6f40582a",null);t["default"]=o.exports},a4c9:function(e,t,n){"use strict";n("4de4"),n("7db0"),n("5db7"),n("caad"),n("d81d"),n("73d9"),n("b0c0"),n("ac1f"),n("2532"),n("841c");var a=n("970b"),r=n("5bc3");Object.defineProperty(t,"__esModule",{value:!0});var i=n("9ab4"),u=i.__importDefault(n("2ef0")),o=i.__importDefault(n("ffe7")),s=n("c437"),c=function(){function e(t,n,r,i,o){a(this,e),this.description_types=["string","text_area","select_one"],this._id=n||s(),this.name=t,this.definitions=u.default.map(i,this.add_id),e.last_used_hex_color=e.last_used_hex_color+1,this.hex_color=r||e.hex_colors[e.last_used_hex_color];var c=u.default.keyBy(this.definitions,"name");this.record_data=u.default(o).map((function(e){return u.default.mapKeys(e,(function(e,t){return"_id"===t?t:c[t]._id}))})).map(this.add_id).value()}return r(e,[{key:"records",value:function(){return u.default.map(this.record_data,this.translate_record.bind(this))}},{key:"schema",value:function(){return this.definitions}},{key:"search",value:function(e){var t=this,n=u.default(this.definitions).filter((function(e){return t.description_types.includes(e.type)})).map((function(e){return e._id})).value(),a=new o.default(this.record_data,{keys:n});return u.default.map(a.search(e),(function(e){return{sheet:t,id:e._id,record:t.translate_record(e)}}))}},{key:"find_by_id",value:function(e){return u.default.find(this?this.record_data:[],{_id:e})}},{key:"add_column",value:function(){var e=this.definitions.length+1;this.definitions.push(this.add_id({name:"Column #".concat(e),type:"string"}))}},{key:"add_row",value:function(){this.record_data.push(this.add_id({}))}},{key:"remove_row",value:function(e){this.record_data=u.default.reject(this.record_data,(function(t){return t._id===e}))}},{key:"translate_record",value:function(e){var t=u.default.keyBy(this.definitions,"_id");return u.default.mapKeys(e,(function(e,n){return"_id"===n?"_id":t[n].name}))}},{key:"record_values",value:function(e){var t=this.unique_id_field(),n={};return n[t]=e[t],n}},{key:"unique_id_field",value:function(){var e=u.default(this.definitions).find({unique_id:!0});return e?e.name:"_id"}},{key:"json_data",value:function(){return{_id:this._id,name:this.name,hex_color:this.hex_color,definitions:this.definitions}}},{key:"add_id",value:function(e){return e["_id"]?e:u.default.assign(e,{_id:s()})}}]),e}();c.hex_colors=["#D11141","#00B159","#00AEDB","#F37735","#FFC425"],c.last_used_hex_color=-1,t.Sheet=c;var d=function(){function e(t){a(this,e),this.sheets=t}return r(e,[{key:"add_sheet",value:function(e){this.sheets.push(e)}},{key:"search",value:function(e){return u.default.flatMap(this.sheets,(function(t){return t.search(e)}))}},{key:"fetch_record",value:function(e){var t=u.default.find(this.sheets,(function(t){return t._id===e.sheet_id}));if(!t)return null;var n=t.find_by_id(e.record_id);return n?{sheet:t,id:e.record_id,record:t.translate_record(n)}:null}},{key:"find_sheet",value:function(e){return u.default.find(this.sheets,{_id:e})}},{key:"json_data",value:function(){var e=this,t=u.default.reduce(this.sheets,(function(e,t){return e[t._id]=t.json_data(),e}),{}),n=u.default.reduce(this.sheets,(function(e,t){return u.default.set(e,t._id,u.default.find(t.definitions,{unique_id:!0}))}),{}),a=u.default.reduce(this.sheets,(function(t,a){var r=u.default.filter(a.definitions,(function(e){return"references"==e.type}));return t[a.name]=u.default.map(a.records(),(function(t){return u.default.reduce(r,(function(t,a){var r=t[a.name];return r&&r.length&&(t[a.name]=u.default.map(r,(function(t){var a=e.fetch_record(t);if(a){t=u.default.set(t,"sheet_name",a.sheet.name);var r=n[a.sheet._id];return r&&(t=u.default.set(t,r.name,a.record[r.name])),t}return t}))),t}),t)})),t}),{});return{sheets:t,records:a}}}]),e}();t.Database=d},a7f4:function(e,t,n){"use strict";n.r(t);var a=n("79e3"),r=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},a855:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("9ab4"),r=a.__importDefault(n("2b0e")),i=a.__importDefault(n("d6dc")),u=a.__importDefault(n("74fb")),o=a.__importDefault(n("8ac8")),s=a.__importDefault(n("9f79")),c=a.__importDefault(n("bd5b")),d=a.__importDefault(n("c2ae")),l=n("c345"),f=a.__importStar(n("a4c9"));t.default=r.default.extend({name:"Sheet",components:{Definition:i.default,Integer:u.default,References:o.default,SelectOne:s.default,String:c.default,TextArea:d.default,ChromePicker:l.Chrome},data:function(){return{colors:{hex:this.sheet.hex_color}}},props:{sheet:f.Sheet,database:f.Database,current_focus:Object},methods:{update_color:function(e){this.sheet.hex_color=e.hex},focus_record:function(e){this.$emit("focus_record",this.sheet._id,e)},record_focused:function(e){return!!this.current_focus&&e._id===this.current_focus.record_id},remove:function(e){this.sheet.remove_row(e)}}})},af2e:function(e,t,n){},b1e3:function(e,t,n){},bd5b:function(e,t,n){"use strict";n.r(t);var a=n("ec7d"),r=n("0cf2");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);var u=n("2877"),o=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,"1f244126",null);t["default"]=o.exports},c2ae:function(e,t,n){"use strict";n.r(t);var a=n("0e4e"),r=n("39aa");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);var u=n("2877"),o=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,"ac35ae54",null);t["default"]=o.exports},c2b3:function(e,t,n){"use strict";var a=n("af2e"),r=n.n(a);r.a},cbe5:function(e,t,n){"use strict";var a=n("75db"),r=n.n(a);r.a},cd49:function(e,t,n){"use strict";n("e260"),n("e6cf"),n("cca6"),n("a79d"),Object.defineProperty(t,"__esModule",{value:!0});var a=n("9ab4"),r=a.__importDefault(n("2b0e")),i=a.__importDefault(n("3dfd"));r.default.config.productionTip=!1,new r.default({render:function(e){return e(i.default)}}).$mount("#app")},d2c3:function(e,t,n){},d543:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"record-result"},[n("span",{staticClass:"sheet",style:"background-color:"+e.result.sheet.hex_color},[e._v(e._s(e.result.sheet.name))]),e._v(" Â» "),e._l(e.result.sheet.record_values(e.result.record),(function(t,a){return n("span",{key:a,staticClass:"property"},[n("span",{staticClass:"key"},[e._v(e._s(a))]),n("span",{staticClass:"value"},[e._v(e._s(t))])])}))],2)},r=[];n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},d6dc:function(e,t,n){"use strict";n.r(t);var a=n("5443"),r=n("38df");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);var u=n("2877"),o=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,"522003d2",null);t["default"]=o.exports},db80:function(e,t,n){"use strict";var a=n("207a"),r=n.n(a);r.a},e4a9:function(e,t,n){"use strict";n.r(t);var a=n("a855"),r=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},e829:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"input-group"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],ref:"the_input",staticClass:"form-control",on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.value=t.target.multiple?n:n[0]},e.update_value]}},[n("option",{attrs:{disabled:"",value:""}},[e._v("Select one")]),e._l(e.definition.options,(function(t){return n("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}))],2)])},r=[];n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},e8eb:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"sheet-modal-"+e.sheet._id,expression:"'sheet-modal-' + sheet._id"}],staticClass:"btn btn-primary"},[e._v("Edit Sheet")]),n("button",{staticClass:"btn btn-primary",on:{click:function(t){return e.sheet.add_column()}}},[e._v("Add Column")]),n("table",{staticClass:"table table-striped table-bordered"},[n("thead",{staticClass:"thead-light"},[n("tr",[e._l(e.sheet.definitions,(function(t,a){return n("th",{key:t._id},[n("Definition",{model:{value:e.sheet.definitions[a],callback:function(t){e.$set(e.sheet.definitions,a,t)},expression:"sheet.definitions[index]"}})],1)})),n("th")],2)]),e._l(e.sheet.record_data,(function(t){return[n("tr",{key:t._id,class:{selected:e.record_focused(t)},on:{click:function(n){return e.focus_record(t._id)}}},[e._l(e.sheet.definitions,(function(a){return n("td",{key:a._id},["string"===a.type?n("String",{model:{value:t[a._id],callback:function(n){e.$set(t,a._id,n)},expression:"record[definition._id]"}}):e._e(),"text_area"===a.type?n("TextArea",{model:{value:t[a._id],callback:function(n){e.$set(t,a._id,n)},expression:"record[definition._id]"}}):e._e(),e._v(" "),"integer"===a.type?n("Integer",{model:{value:t[a._id],callback:function(n){e.$set(t,a._id,n)},expression:"record[definition._id]"}}):e._e(),"references"===a.type?n("References",{attrs:{database:e.database,record_id:t._id},model:{value:t[a._id],callback:function(n){e.$set(t,a._id,n)},expression:"record[definition._id]"}}):e._e(),"select_one"===a.type?n("SelectOne",{attrs:{definition:a},model:{value:t[a._id],callback:function(n){e.$set(t,a._id,n)},expression:"record[definition._id]"}}):e._e()],1)})),n("td",[n("a",{staticClass:"remove",on:{click:function(n){return e.remove(t._id)}}},[e._v("ðŸ—‘")])])],2)]}))],2),n("button",{staticClass:"btn btn-primary add-row-btn",on:{click:function(t){return e.sheet.add_row()}}},[e._v("Add Row")]),n("b-modal",{attrs:{id:"sheet-modal-"+e.sheet._id,title:"Edit Sheet"}},[n("div",{staticClass:"form-group"},[n("label",[e._v(" Name "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.sheet.name,expression:"sheet.name"}],staticClass:"form-control",domProps:{value:e.sheet.name},on:{input:function(t){t.target.composing||e.$set(e.sheet,"name",t.target.value)}}})])]),n("div",{staticClass:"form-group"},[n("label",[e._v(" Color "),n("ChromePicker",{attrs:{value:e.colors},on:{input:e.update_color}})],1)])])],1)},r=[];n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},ec7d:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"input-group"},[n("input",{ref:"the_input",staticClass:"form-control",domProps:{value:e.value},on:{input:e.update_value}})])},r=[];n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},f972:function(e,t,n){"use strict";n.r(t);var a=n("55c2"),r=n("fd15");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("cbe5");var u=n("2877"),o=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,"68291e56",null);t["default"]=o.exports},fa12:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"input-group referenced-object"},[e._l(e.referenced_records(),(function(t){return n("div",{key:t.id},[n("a",{staticClass:"remove",on:{click:function(n){return e.remove(t)}}},[e._v("ðŸ—‘")]),n("RecordResult",{attrs:{result:t,database:e.database}})],1)})),n("div",{staticClass:"search"},[n("b-input-group",{attrs:{prepend:"ðŸ”Ž"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.match_text,expression:"match_text"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.match_text},on:{input:function(t){t.target.composing||(e.match_text=t.target.value)}}})]),e.match_text?n("div",{staticClass:"results"},[n("b-list-group",e._l(e.search_results(),(function(t){return n("b-list-group-item",{key:t.id,staticClass:"search_result",attrs:{button:"",variant:"secondary"},on:{click:function(n){return e.choose(t,n)}}},[n("RecordResult",{attrs:{result:t,database:e.database}})],1)})),1)],1):e._e()],1)],2)},r=[];n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},fb57:function(e,t,n){"use strict";n("a9e3"),n("e25e"),Object.defineProperty(t,"__esModule",{value:!0});var a=n("9ab4"),r=a.__importDefault(n("2b0e"));t.default=r.default.extend({name:"Integer",props:{value:Number},methods:{update_value:function(e){this.$emit("input",parseInt(e.target.value))}}})},fceb:function(e,t,n){"use strict";n.r(t);var a=n("e8eb"),r=n("e4a9");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("db80");var u=n("2877"),o=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,"1722edf2",null);t["default"]=o.exports},fd15:function(e,t,n){"use strict";n.r(t);var a=n("3383"),r=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a}});
//# sourceMappingURL=app.2b58cb21.js.map